<div class="services">         
  <div class="service-sidebar">
    <%= render partial: "backstage_sidebar" %>
  </div>        
  <div class="service-display">
    <h3>會員總覽(<%= @users.count if @users %>)</h3>
    <br> 
    <% verified_member = @users.select{|u| u.verified == true and u.admin == false} %>
    <% not_verified_member = @users.select{|u| u.verified == false and u.admin == false} %>
    <% admin_member = @users.select{|u| u.admin == true} %>
    <div role="tabpanel">
        <!-- Nav tabs -->
        <ul class="nav nav-tabs">
          <li class="active">
            <a href="#member" data-toggle="tab">
              <h4>驗證會員(<%= verified_member.count %>)</h4>
            </a>
          </li>
          <li>
            <a href="#not_verified" data-toggle="tab">
              <h4>未驗證(<%= not_verified_member.count %>)</h4>
            </a>
          </li>
          <li>
            <a href="#admin" data-toggle="tab">
              <h4>管理者(<%= admin_member.count %>)</h4>
            </a>
          </li>        
          <li>
            <a href="#reservation" data-toggle="tab">
              <h4>最新預約(<%= @reservations.count %>)</h4>
            </a>
          </li>               
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">
          <div class="tab-pane active" id="member">
            <%= render partial: "member_show", locals: {member: verified_member}  %>
          </div>            
          <div class="tab-pane" id="not_verified">
            <%= render partial: "member_show", locals: {member: not_verified_member}  %>
          </div>  
          <div class="tab-pane" id="admin">
            <%= render partial: "member_show", locals: {member: admin_member}  %>
          </div>
          <div class="tab-pane" id="reservation">
            <div class="container-fluid">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th width="5%"> </th>
                    <th width="13%" >姓名</th>
                    <th width="18%" >預約時間</th>
                    <th width="15%" >預約時段</th>
                    <th width="45%" >系統建立時間</th>       
                    <th width="5%"></th>                        
                  </tr>
                </thead>
                <tbody>
                  <% @reservations.each do |r| %>
                  <tr>
                    <td>
                      <%= link_to backstage_user_show_path(user: r.user) do %>
                        <span class="glyphicon glyphicon-search", style="top: 3px"></span>
                      <% end %>
                    </td>                      
                    <td><%= r.user.name %></td>
                    <td><%= r.booking_slot.booking_date %></td>
                    <td><%= show_time_slot(r.booking_slot.time_slot) %></td>
                    <td><%= show_datetime(r.created_at) %></td>
                    <td>
                      <%= link_to reservation_path(r), method: :delete, data: {confirm: "你確定刪除預約嗎?"} do %>
                        <span class="glyphicon glyphicon-remove", style="top: 3px"></span>
                      <% end %>
                    </td>                              
                  </tr>
                  <% end %>
                </tbody>
              </table>
            </div>                  
          </div>          
        </div>
    </div>


  </div>
  <div class="clear"> </div>
</div>
<div class="clear"> </div>
